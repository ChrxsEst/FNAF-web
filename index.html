<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Five Nights at Freddy's</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #fff;
            overflow: hidden;
        }

        /* Men√∫ Principal */
        #menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(180deg, #1a0000 0%, #000 100%);
        }

        #menu h1 {
            font-size: 3em;
            color: #ff0000;
            text-shadow: 0 0 20px #ff0000;
            margin-bottom: 50px;
            animation: flicker 2s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .menu-btn {
            background: #330000;
            border: 2px solid #ff0000;
            color: #fff;
            padding: 15px 40px;
            margin: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .menu-btn:hover {
            background: #ff0000;
            box-shadow: 0 0 20px #ff0000;
        }

        /* Selector de Dificultad */
        #difficulty-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: #0a0a0a;
        }

        .difficulty-btn {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 20px 60px;
            margin: 15px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .difficulty-btn:hover {
            background: #00ff00;
            color: #000;
        }

        /* Controles */
        #controls-screen {
            display: none;
            padding: 50px;
            height: 100vh;
            background: #0a0a0a;
            overflow-y: auto;
        }

        #controls-screen h2 {
            color: #ff0000;
            margin-bottom: 30px;
        }

        #controls-screen p {
            margin: 15px 0;
            line-height: 1.6;
        }

        /* Juego */
        #game {
            display: none;
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        /* Oficina */
        #office {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #1a1a2e 0%, #0f0f1e 100%);
            position: relative;
        }

        .office-view {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: #666;
            position: relative;
        }

        /* Golden Freddy en oficina */
        #golden-freddy {
            display: none;
            position: absolute;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 400px;
            background: linear-gradient(135deg, #FFD700 0%, #8B7500 100%);
            border: 5px solid #FFD700;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            color: #000;
            cursor: pointer;
            animation: goldenGlitch 0.5s infinite;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
            z-index: 90;
        }

        @keyframes goldenGlitch {
            0%, 100% { opacity: 1; transform: translateX(-50%) translateY(0); }
            25% { opacity: 0.8; transform: translateX(-50%) translateY(-5px); }
            50% { opacity: 0.9; transform: translateX(-50%) translateY(5px); }
            75% { opacity: 0.85; transform: translateX(-50%) translateY(-3px); }
        }

        /* HUD */
        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
        }

        #battery-container {
            background: rgba(0,0,0,0.8);
            padding: 10px 20px;
            margin: 5px 0;
            border: 2px solid #00ff00;
        }

        #battery-label {
            font-size: 1em;
            margin-bottom: 5px;
            color: #00ff00;
        }

        #battery-bars {
            display: flex;
            gap: 5px;
        }

        .battery-bar {
            width: 30px;
            height: 40px;
            border: 2px solid #333;
            background: #222;
            position: relative;
        }

        .battery-bar.full {
            background: linear-gradient(180deg, #00ff00 0%, #00cc00 100%);
            border-color: #00ff00;
        }

        .battery-bar.high {
            background: linear-gradient(180deg, #90EE90 0%, #00ff00 100%);
            border-color: #00ff00;
        }

        .battery-bar.medium {
            background: linear-gradient(180deg, #ffff00 0%, #ffa500 100%);
            border-color: #ffff00;
        }

        .battery-bar.low {
            background: linear-gradient(180deg, #ff6600 0%, #ff0000 100%);
            border-color: #ff0000;
        }

        #time {
            background: rgba(0,0,0,0.8);
            padding: 10px 20px;
            margin: 5px 0;
            border: 2px solid #00ff00;
            font-size: 1.2em;
        }

        /* Puertas */
        .door {
            position: absolute;
            width: 150px;
            height: 100px;
            bottom: 20%;
            background: #555;
            border: 3px solid #333;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            z-index: 90;
        }

        #left-door {
            left: 50px;
        }

        #right-door {
            right: 50px;
        }

        .door.closed {
            background: #ff0000;
        }

        /* Indicador de animatr√≥nico en puerta */
        .door-indicator {
            position: absolute;
            bottom: 35%;
            width: 200px;
            height: 250px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            z-index: 85;
            pointer-events: none;
            opacity: 0.8;
        }

        #left-indicator {
            left: 30px;
        }

        #right-indicator {
            right: 30px;
        }

        /* Sistema de C√°maras */
        #camera-system {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 50;
        }

        #camera-view {
            width: 80%;
            height: 60%;
            margin: 2% auto 0;
            border: 5px solid #00ff00;
            background: #1a1a1a;
            position: relative;
            overflow: hidden;
        }

        .camera-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 20px;
            font-size: 1.5em;
            color: #00ff00;
            position: relative;
        }

        .animatronic {
            width: 140px;
            height: 200px;
            background: #444;
            border: 3px solid #fff;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1em;
            font-weight: bold;
            margin: 10px;
            flex-shrink: 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        .animatronics-container {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            margin-top: 80px;
            max-width: 95%;
        }

        #camera-name {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 10px 20px;
            border: 2px solid #00ff00;
            font-size: 0.8em;
        }

        #camera-map {
            width: 90%;
            margin: 20px auto 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 20px;
        }

        #toggle-camera {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 40px;
            background: #333;
            border: 2px solid #00ff00;
            color: #00ff00;
            cursor: pointer;
            font-size: 1.2em;
            z-index: 101;
        }

        #toggle-camera:hover {
            background: #00ff00;
            color: #000;
        }

        .camera-btn {
            background: #222;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .camera-btn:hover, .camera-btn.active {
            background: #00ff00;
            color: #000;
        }

        /* Bot√≥n de pausa */
        #pause-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: #333;
            border: 2px solid #ffff00;
            color: #ffff00;
            cursor: pointer;
            font-size: 1.1em;
            z-index: 102;
        }

        #pause-btn:hover {
            background: #ffff00;
            color: #000;
        }

        /* Men√∫ de pausa */
        #pause-menu {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 150;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #pause-menu h2 {
            color: #ffff00;
            font-size: 3em;
            margin-bottom: 50px;
        }

        .pause-btn {
            background: #333;
            border: 2px solid #ffff00;
            color: #ffff00;
            padding: 15px 50px;
            margin: 15px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pause-btn:hover {
            background: #ffff00;
            color: #000;
        }

        /* Pantalla de salida */
        #quit-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #quit-screen h2 {
            color: #ff0000;
            font-size: 4em;
            margin-bottom: 30px;
        }

        /* Pantalla del peri√≥dico */
        #newspaper-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 201;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        #newspaper-screen img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            box-shadow: 0 0 50px rgba(255,255,0,0.3);
        }

        /* Pantalla de jumpscare */
        #jumpscare-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 202;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        #jumpscare-text {
            text-align: center;
            margin-bottom: 30px;
            animation: flicker 0.5s infinite;
        }

        #jumpscare-text h2 {
            color: #ff0000;
            font-size: 5em;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #ff0000;
        }

        #jumpscare-text p {
            color: #ff0000;
            font-size: 2em;
            text-shadow: 0 0 10px #ff0000;
        }

        #jumpscare-screen img {
            max-width: 70%;
            max-height: 60%;
            object-fit: contain;
            animation: jumpscare 0.3s ease-in-out;
        }

        @keyframes jumpscare {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #game-over h2 {
            color: #ff0000;
            font-size: 4em;
            margin-bottom: 30px;
            animation: flicker 1s infinite;
        }

        /* Victoria */
        #victory {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #001a00 0%, #000 100%);
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #victory h2 {
            color: #00ff00;
            font-size: 4em;
            margin-bottom: 30px;
        }

        .static {
            animation: static 0.1s infinite;
        }

        @keyframes static {
            0% { filter: grayscale(100%) contrast(200%); }
            50% { filter: grayscale(100%) contrast(150%); }
            100% { filter: grayscale(100%) contrast(200%); }
        }
    </style>
</head>
<body>
    <!-- Men√∫ Principal -->
    <div id="menu">
        <h1>FIVE NIGHTS AT FREDDY'S</h1>
        <button class="menu-btn" onclick="showDifficulty()">JUGAR</button>
        <button class="menu-btn" onclick="showControls()">CONTROLES</button>
    </div>

    <!-- Selector de Dificultad -->
    <div id="difficulty-screen">
        <h2 style="margin-bottom: 40px; font-size: 2em;">SELECCIONA LA DIFICULTAD</h2>
        <button class="difficulty-btn" onclick="startGame(1)">F√ÅCIL</button>
        <button class="difficulty-btn" onclick="startGame(2)">NORMAL</button>
        <button class="difficulty-btn" onclick="startGame(3)">DIF√çCIL</button>
        <button class="menu-btn" onclick="backToMenu()" style="margin-top: 30px;">VOLVER</button>
    </div>

    <!-- Pantalla de Controles -->
    <div id="controls-screen">
        <h2>CONTROLES DEL JUEGO</h2>
        <p><strong>ESPACIO:</strong> Abrir/Cerrar sistema de c√°maras</p>
        <p><strong>CLICK en botones de c√°mara:</strong> Cambiar entre c√°maras</p>
        <p><strong>CLICK en puertas:</strong> Abrir/Cerrar puertas (consume bater√≠a cuando est√°n cerradas)</p>
        <p><strong>CLICK en luces:</strong> Iluminar puertas para ver si hay animatr√≥nicos (consume bater√≠a)</p>
        <br>
        <h3>OBJETIVO:</h3>
        <p>Sobrevive desde las 12 AM hasta las 6 AM (6 minutos reales)</p>
        <p>Vigila a los animatr√≥nicos en las c√°maras</p>
        <p>Cierra las puertas cuando est√©n cerca</p>
        <p>¬°Administra tu bater√≠a sabiamente!</p>
        <br>
        <h3>ANIMATR√ìNICOS:</h3>
        <p><strong>FREDDY:</strong> Se mueve lentamente pero es muy peligroso</p>
        <p><strong>BONNIE:</strong> Ataca por la puerta izquierda</p>
        <p><strong>CHICA:</strong> Ataca por la puerta derecha</p>
        <p><strong>FOXY:</strong> Si no lo vigilas, corre hacia tu oficina</p>
        <button class="menu-btn" onclick="backToMenu()" style="margin-top: 30px;">VOLVER</button>
    </div>

    <!-- Juego -->
    <div id="game">
        <!-- Bot√≥n de pausa -->
        <button id="pause-btn" onclick="togglePause()">‚è∏ PAUSA</button>

        <!-- HUD -->
        <div id="hud">
            <div id="battery-container">
                <div id="battery-label">BATER√çA</div>
                <div id="battery-bars">
                    <div class="battery-bar full" id="bar1"></div>
                    <div class="battery-bar full" id="bar2"></div>
                    <div class="battery-bar full" id="bar3"></div>
                    <div class="battery-bar full" id="bar4"></div>
                </div>
            </div>
            <div id="time">12 AM</div>
        </div>

        <!-- Oficina -->
        <div id="office">
            <div class="office-view">
                OFICINA DE SEGURIDAD
                
                <!-- Golden Freddy (solo en modo dif√≠cil) -->
                <div id="golden-freddy" onclick="dismissGoldenFreddy()">
                    <div style="font-size: 1.5em;">üëª</div>
                    <div>GOLDEN</div>
                    <div>FREDDY</div>
                </div>
                
                <!-- Indicadores de animatr√≥nicos en puertas -->
                <div id="left-indicator" class="door-indicator"></div>
                <div id="right-indicator" class="door-indicator"></div>
            </div>
            
            <!-- Puertas -->
            <div id="left-door" class="door" onclick="toggleDoor('left')">
                <div>PUERTA IZQ</div>
                <div>ABIERTA</div>
            </div>
            <div id="right-door" class="door" onclick="toggleDoor('right')">
                <div>PUERTA DER</div>
                <div>ABIERTA</div>
            </div>
        </div>

        <!-- Sistema de C√°maras -->
        <div id="camera-system">
            <div id="camera-view">
                <div class="camera-content static">
                    <span id="camera-name">C√ÅMARA 1A - ESCENARIO</span>
                    <div class="animatronics-container">
                        <div id="freddy-cam" class="animatronic" style="background: linear-gradient(135deg, #8B4513 0%, #654321 100%); border-color: #654321;">
                            <div style="font-size: 1.2em;">üêª</div>
                            <div>FREDDY</div>
                        </div>
                        <div id="bonnie-cam" class="animatronic" style="background: linear-gradient(135deg, #6A5ACD 0%, #4B0082 100%); border-color: #4B0082;">
                            <div style="font-size: 1.2em;">üê∞</div>
                            <div>BONNIE</div>
                        </div>
                        <div id="chica-cam" class="animatronic" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: #000; border-color: #FFA500;">
                            <div style="font-size: 1.2em;">üê§</div>
                            <div>CHICA</div>
                        </div>
                        <div id="foxy-cam" class="animatronic" style="background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%); border-color: #8B0000;">
                            <div style="font-size: 1.2em;">ü¶ä</div>
                            <div>FOXY</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="camera-map">
                <button class="camera-btn active" onclick="switchCamera('1A')">CAM 1A<br>ESCENARIO</button>
                <button class="camera-btn" onclick="switchCamera('1B')">CAM 1B<br>COMEDOR</button>
                <button class="camera-btn" onclick="switchCamera('1C')">CAM 1C<br>PIRATE COVE</button>
                <button class="camera-btn" onclick="switchCamera('2A')">CAM 2A<br>PASILLO IZQ</button>
                <button class="camera-btn" onclick="switchCamera('2B')">CAM 2B<br>PASILLO DER</button>
                <button class="camera-btn" onclick="switchCamera('3')">CAM 3<br>SUMINISTROS</button>
                <button class="camera-btn" onclick="switchCamera('4A')">CAM 4A<br>PUERTA IZQ</button>
                <button class="camera-btn" onclick="switchCamera('4B')">CAM 4B<br>PUERTA DER</button>
            </div>
        </div>

        <button id="toggle-camera" onclick="toggleCamera()">ABRIR C√ÅMARAS [ESPACIO]</button>

        <!-- Men√∫ de pausa -->
        <div id="pause-menu">
            <h2>PAUSA</h2>
            <button class="pause-btn" onclick="togglePause()">REANUDAR</button>
            <button class="pause-btn" onclick="quitGame()">SALIR</button>
        </div>

        <!-- Pantalla de salida -->
        <div id="quit-screen">
            <h2>HAS PERDIDO</h2>
            <p style="font-size: 1.5em; margin-bottom: 30px;">Abandonaste la noche...</p>
            <button class="menu-btn" onclick="showNewspaper()">CONTINUAR</button>
        </div>

        <!-- Pantalla del peri√≥dico (abandono) -->
        <div id="newspaper-screen" onclick="handleNewspaperClick()">
            <img src="golden.jpg" alt="Golden Freddy">
        </div>

        <!-- Pantalla de jumpscare -->
        <div id="jumpscare-screen" onclick="handleJumpscareClick()">
            <div id="jumpscare-text">
                <h2>¬°PERDISTE!</h2>
                <p id="jumpscare-message"></p>
            </div>
            <img id="jumpscare-img" src="" alt="Jumpscare">
        </div>

        <!-- Game Over -->
        <div id="game-over">
            <h2>GAME OVER</h2>
            <p style="font-size: 1.5em; margin-bottom: 30px;">Has sido atrapado...</p>
            <button class="menu-btn" onclick="location.reload()">REINTENTAR</button>
        </div>

        <!-- Victoria -->
        <div id="victory">
            <h2>¬°6 AM!</h2>
            <p style="font-size: 1.5em; margin-bottom: 30px; color: #00ff00;">¬°Has sobrevivido la noche!</p>
            <button class="menu-btn" onclick="location.reload()">VOLVER AL MEN√ö</button>
        </div>
    </div>

    <script>
        // Variables del juego
        let battery = 100;
        let hour = 0;
        let difficulty = 1;
        let gameRunning = false;
        let gamePaused = false;
        let cameraOpen = false;
        let leftDoorClosed = false;
        let rightDoorClosed = false;
        let currentCamera = '1A';
        let gameIntervals = [];
        let goldenFreddyActive = false;
        let goldenFreddyTimeout = null;

        // Posiciones de los animatr√≥nicos
        const animatronics = {
            freddy: { position: '1A', atDoor: false, side: null },
            bonnie: { position: '1A', atDoor: false, side: 'left' },
            chica: { position: '1A', atDoor: false, side: 'right' },
            foxy: { position: '1C', stage: 0, atDoor: false, side: 'left' }
        };

        const cameras = ['1A', '1B', '2A', '2B', '3', '4A', '4B'];
        const foxyStages = ['1C', '1C', '1C', '2A'];

        // Funciones de men√∫
        function showDifficulty() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('difficulty-screen').style.display = 'flex';
        }

        function showControls() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('controls-screen').style.display = 'block';
        }

        function backToMenu() {
            document.getElementById('menu').style.display = 'flex';
            document.getElementById('difficulty-screen').style.display = 'none';
            document.getElementById('controls-screen').style.display = 'none';
        }

        function startGame(diff) {
            difficulty = diff;
            document.getElementById('difficulty-screen').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            
            // RESET: Todos empiezan en escenario excepto Foxy
            animatronics.freddy.position = '1A';
            animatronics.freddy.atDoor = false;
            animatronics.bonnie.position = '1A';
            animatronics.bonnie.atDoor = false;
            animatronics.chica.position = '1A';
            animatronics.chica.atDoor = false;
            animatronics.foxy.position = '1C';
            animatronics.foxy.stage = 0;
            animatronics.foxy.atDoor = false;
            
            battery = 100;
            hour = 0;
            leftDoorClosed = false;
            rightDoorClosed = false;
            cameraOpen = false;
            currentCamera = '1A';
            
            // Resetear puertas visualmente
            document.getElementById('left-door').classList.remove('closed');
            document.getElementById('right-door').classList.remove('closed');
            document.getElementById('left-door').children[1].textContent = 'ABIERTA';
            document.getElementById('right-door').children[1].textContent = 'ABIERTA';
            
            gameRunning = true;
            
            // Actualizar vista inicial
            updateCameraView();
            updateBattery();
            document.getElementById('time').textContent = '12 AM';
            
            initGame();
        }

        function initGame() {
            // Limpiar intervalos anteriores
            gameIntervals.forEach(interval => clearInterval(interval));
            gameIntervals = [];
            
            // Iniciar reloj (6 minutos = 360 segundos = 6 horas del juego)
            gameIntervals.push(setInterval(updateTime, 60000)); // 1 hora = 1 minuto real
            
            // Consumo de bater√≠a
            gameIntervals.push(setInterval(updateBattery, 100));
            
            // Movimiento de animatr√≥nicos (velocidad ajustada por dificultad)
            const moveSpeed = difficulty === 3 ? 7000 : (difficulty === 2 ? 5000 : 8000);
            gameIntervals.push(setInterval(moveAnimatronics, moveSpeed));
            
            // Foxy check (velocidad ajustada por dificultad)
            const foxySpeed = difficulty === 3 ? 4000 : (difficulty === 2 ? 3000 : 5000);
            gameIntervals.push(setInterval(foxyCheck, foxySpeed));
            
            // Golden Freddy solo en modo dif√≠cil
            if (difficulty === 3) {
                gameIntervals.push(setInterval(trySpawnGoldenFreddy, 2000)); // Cada 2 segundos intenta aparecer (10% prob)
            }
        }

        function updateTime() {
            if (!gameRunning || gamePaused) return;
            hour++;
            document.getElementById('time').textContent = `${hour + 12 > 12 ? hour : hour + 12} AM`;
            
            if (hour >= 6) {
                victory();
            }
        }

        function updateBattery() {
            if (!gameRunning || gamePaused) return;
            
            let drain = 0;
            if (cameraOpen) drain += 0.05;
            if (leftDoorClosed) drain += 0.1;
            if (rightDoorClosed) drain += 0.1;
            
            battery -= drain * difficulty * 0.1;
            battery = Math.max(0, battery);
            
            // Actualizar barras de bater√≠a
            const bars = [
                document.getElementById('bar1'),
                document.getElementById('bar2'),
                document.getElementById('bar3'),
                document.getElementById('bar4')
            ];
            
            // Calcular cu√°ntas barras est√°n llenas
            const fullBars = Math.ceil(battery / 25);
            
            bars.forEach((bar, index) => {
                bar.className = 'battery-bar';
                if (index < fullBars) {
                    // Determinar el color seg√∫n el nivel de bater√≠a
                    if (battery > 75) {
                        bar.classList.add('full');
                    } else if (battery > 50) {
                        bar.classList.add('high');
                    } else if (battery > 25) {
                        bar.classList.add('medium');
                    } else {
                        bar.classList.add('low');
                    }
                }
            });
            
            // Actualizar color del label
            const label = document.getElementById('battery-label');
            if (battery > 50) {
                label.style.color = '#00ff00';
            } else if (battery > 25) {
                label.style.color = '#ffff00';
            } else {
                label.style.color = '#ff0000';
            }
            
            if (battery <= 0) {
                powerOut();
            }
        }

        // Funciones de pausa
        function togglePause() {
            gamePaused = !gamePaused;
            document.getElementById('pause-menu').style.display = gamePaused ? 'flex' : 'none';
        }

        function quitGame() {
            gameRunning = false;
            gamePaused = false;
            document.getElementById('pause-menu').style.display = 'none';
            document.getElementById('quit-screen').style.display = 'flex';
        }

        function showNewspaper() {
            document.getElementById('quit-screen').style.display = 'none';
            document.getElementById('newspaper-screen').style.display = 'flex';
            
            // Despu√©s de 5 segundos, permitir click
            setTimeout(() => {
                document.getElementById('newspaper-screen').style.pointerEvents = 'auto';
            }, 5000);
        }

        function switchCamera(cam) {
            currentCamera = cam;
            document.querySelectorAll('.camera-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const names = {
                '1A': 'C√ÅMARA 1A - ESCENARIO',
                '1B': 'C√ÅMARA 1B - COMEDOR',
                '1C': 'C√ÅMARA 1C - PIRATE COVE',
                '2A': 'C√ÅMARA 2A - PASILLO IZQUIERDO',
                '2B': 'C√ÅMARA 2B - PASILLO DERECHO',
                '3': 'C√ÅMARA 3 - SUMINISTROS',
                '4A': 'C√ÅMARA 4A - PUERTA IZQUIERDA',
                '4B': 'C√ÅMARA 4B - PUERTA DERECHA'
            };
            
            document.getElementById('camera-name').textContent = names[cam];
            updateCameraView();
        }

        function updateCameraView() {
            // Ocultar todos primero
            document.querySelectorAll('.animatronic').forEach(a => a.style.display = 'none');
            
            // Mostrar los que est√°n en la c√°mara actual
            if (animatronics.freddy.position === currentCamera) {
                document.getElementById('freddy-cam').style.display = 'flex';
            }
            if (animatronics.bonnie.position === currentCamera) {
                document.getElementById('bonnie-cam').style.display = 'flex';
            }
            if (animatronics.chica.position === currentCamera) {
                document.getElementById('chica-cam').style.display = 'flex';
            }
            if (animatronics.foxy.position === currentCamera) {
                document.getElementById('foxy-cam').style.display = 'flex';
            }
            
            // Actualizar texto de la c√°mara con contador
            const animsInCamera = [
                animatronics.freddy.position === currentCamera ? 'FREDDY' : null,
                animatronics.bonnie.position === currentCamera ? 'BONNIE' : null,
                animatronics.chica.position === currentCamera ? 'CHICA' : null,
                animatronics.foxy.position === currentCamera ? 'FOXY' : null
            ].filter(a => a !== null);
            
            const names = {
                '1A': 'C√ÅMARA 1A - ESCENARIO',
                '1B': 'C√ÅMARA 1B - COMEDOR',
                '1C': 'C√ÅMARA 1C - PIRATE COVE',
                '2A': 'C√ÅMARA 2A - PASILLO IZQUIERDO',
                '2B': 'C√ÅMARA 2B - PASILLO DERECHO',
                '3': 'C√ÅMARA 3 - SUMINISTROS',
                '4A': 'C√ÅMARA 4A - PUERTA IZQUIERDA',
                '4B': 'C√ÅMARA 4B - PUERTA DERECHA'
            };
            
            let cameraText = names[currentCamera];
            if (animsInCamera.length > 0) {
                cameraText += ` (${animsInCamera.length})`;
            }
            
            document.getElementById('camera-name').textContent = cameraText;
        }

        function moveAnimatronics() {
            if (!gameRunning || gamePaused) return;
            
            // Probabilidades ajustadas por dificultad
            const freddyChance = difficulty === 3 ? 0.25 : (difficulty === 2 ? 0.3 : 0.2);
            const bonnieChance = difficulty === 3 ? 0.35 : (difficulty === 2 ? 0.4 : 0.3);
            const chicaChance = difficulty === 3 ? 0.35 : (difficulty === 2 ? 0.4 : 0.3);
            
            // Freddy
            if (Math.random() < freddyChance) {
                moveAnimatronic('freddy');
            }
            
            // Bonnie (izquierda)
            if (Math.random() < bonnieChance) {
                moveAnimatronic('bonnie', ['1A', '1B', '2A', '3', '4A']);
            }
            
            // Chica (derecha)
            if (Math.random() < chicaChance) {
                moveAnimatronic('chica', ['1A', '1B', '2B', '3', '4B']);
            }
        }

        function moveAnimatronic(name, route = cameras) {
            const anim = animatronics[name];
            if (anim.atDoor) return;
            
            const currentIndex = route.indexOf(anim.position);
            if (currentIndex < route.length - 1) {
                anim.position = route[currentIndex + 1];
                
                // Si llega a una c√°mara de puerta (4A o 4B), marcar que est√° en la puerta
                if ((name === 'bonnie' && anim.position === '4A') ||
                    (name === 'chica' && anim.position === '4B') ||
                    (name === 'freddy' && (anim.position === '4A' || anim.position === '4B'))) {
                    anim.atDoor = true;
                    
                    // Guardar en qu√© lado est√° Freddy
                    if (name === 'freddy') {
                        anim.side = anim.position === '4A' ? 'left' : 'right';
                    }
                    
                    // Esperar un momento antes de intentar entrar
                    setTimeout(() => {
                        attemptEntry(name);
                    }, 3000);
                }
            }
            updateCameraView();
            updateDoorIndicators();
        }

        function foxyCheck() {
            if (!gameRunning || gamePaused) return;
            
            // Si no miras a Foxy, avanza
            if (currentCamera !== '1C' && cameraOpen) {
                animatronics.foxy.stage++;
                
                if (animatronics.foxy.stage >= foxyStages.length) {
                    foxyRun();
                } else {
                    animatronics.foxy.position = foxyStages[animatronics.foxy.stage];
                }
            }
        }

        function foxyRun() {
            animatronics.foxy.atDoor = true;
            animatronics.foxy.position = '4A';
            updateDoorIndicators();
            
            setTimeout(() => {
                attemptEntry('foxy');
            }, 2000);
        }

        function attemptEntry(name) {
            if (!gameRunning || gamePaused) return;
            
            const anim = animatronics[name];
            if (!anim.atDoor) return;
            
            // Verificar si la puerta correcta est√° cerrada
            const doorClosed = (anim.side === 'left' && leftDoorClosed) || 
                              (anim.side === 'right' && rightDoorClosed);
            
            if (!doorClosed) {
                // Si la puerta est√° abierta, entra y mata al jugador
                gameOver(`${name.charAt(0).toUpperCase() + name.slice(1)} te ha atrapado!`);
            } else {
                // Si la puerta est√° cerrada, se va despu√©s de un tiempo
                if (name === 'foxy') {
                    battery -= 10; // Foxy drena bater√≠a aunque cierres
                }
                
                setTimeout(() => {
                    anim.atDoor = false;
                    anim.position = '1A';
                    if (name === 'foxy') {
                        animatronics.foxy.stage = 0;
                        animatronics.foxy.position = '1C';
                    }
                    updateDoorIndicators();
                }, 5000);
            }
        }

        function updateDoorIndicators() {
            const leftIndicator = document.getElementById('left-indicator');
            const rightIndicator = document.getElementById('right-indicator');
            
            // Limpiar indicadores
            leftIndicator.style.display = 'none';
            rightIndicator.style.display = 'none';
            leftIndicator.innerHTML = '';
            rightIndicator.innerHTML = '';
            
            // Mostrar animatr√≥nicos en las puertas
            if (animatronics.bonnie.atDoor && animatronics.bonnie.position === '4A') {
                leftIndicator.innerHTML = `
                    <div style="background: linear-gradient(135deg, #6A5ACD 0%, #4B0082 100%); 
                                border: 3px solid #4B0082; padding: 20px; width: 100%; height: 100%;
                                display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <div style="font-size: 2em;">üê∞</div>
                        <div>BONNIE</div>
                    </div>
                `;
                leftIndicator.style.display = 'flex';
            }
            
            if (animatronics.chica.atDoor && animatronics.chica.position === '4B') {
                rightIndicator.innerHTML = `
                    <div style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); 
                                border: 3px solid #FFA500; padding: 20px; width: 100%; height: 100%;
                                display: flex; flex-direction: column; align-items: center; justify-content: center;
                                color: #000;">
                        <div style="font-size: 2em;">üê§</div>
                        <div>CHICA</div>
                    </div>
                `;
                rightIndicator.style.display = 'flex';
            }
            
            if (animatronics.foxy.atDoor && animatronics.foxy.position === '4A') {
                leftIndicator.innerHTML = `
                    <div style="background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%); 
                                border: 3px solid #8B0000; padding: 20px; width: 100%; height: 100%;
                                display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <div style="font-size: 2em;">ü¶ä</div>
                        <div>FOXY</div>
                    </div>
                `;
                leftIndicator.style.display = 'flex';
            }
            
            if (animatronics.freddy.atDoor) {
                const side = animatronics.freddy.side === 'left' ? leftIndicator : rightIndicator;
                side.innerHTML = `
                    <div style="background: linear-gradient(135deg, #8B4513 0%, #654321 100%); 
                                border: 3px solid #654321; padding: 20px; width: 100%; height: 100%;
                                display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <div style="font-size: 2em;">üêª</div>
                        <div>FREDDY</div>
                    </div>
                `;
                side.style.display = 'flex';
            }
        }

        function toggleDoor(side) {
            if (side === 'left') {
                leftDoorClosed = !leftDoorClosed;
                const door = document.getElementById('left-door');
                door.classList.toggle('closed');
                door.children[1].textContent = leftDoorClosed ? 'CERRADA' : 'ABIERTA';
            } else {
                rightDoorClosed = !rightDoorClosed;
                const door = document.getElementById('right-door');
                door.classList.toggle('closed');
                door.children[1].textContent = rightDoorClosed ? 'CERRADA' : 'ABIERTA';
            }
        }

        function powerOut() {
            gameRunning = false;
            document.getElementById('office').style.background = '#000';
            setTimeout(() => {
                gameOver('¬°Se acab√≥ la energ√≠a!');
            }, 3000);
        }

        function gameOver(msg) {
            gameRunning = false;
            
            // Determinar qu√© animatr√≥nico caus√≥ el game over
            let jumpscareImage = '';
            let animatronicName = '';
            
            if (msg.includes('Freddy')) {
                jumpscareImage = 'fredy.jpg';
                animatronicName = 'Freddy';
            } else if (msg.includes('Bonnie')) {
                jumpscareImage = 'boni.jpg';
                animatronicName = 'Bonnie';
            } else if (msg.includes('Chica')) {
                jumpscareImage = 'chica.jpeg';
                animatronicName = 'Chica';
            } else if (msg.includes('Foxy')) {
                jumpscareImage = 'foxy.jpg';
                animatronicName = 'Foxy';
            } else if (msg.includes('Golden')) {
                jumpscareImage = 'golden.jpg';
                animatronicName = 'Golden Freddy';
            } else {
                jumpscareImage = 'golden.jpg';
                animatronicName = 'La oscuridad';
            }
            
            // Mostrar jumpscare
            const jumpscareScreen = document.getElementById('jumpscare-screen');
            const jumpscareImg = document.getElementById('jumpscare-img');
            const jumpscareMessage = document.getElementById('jumpscare-message');
            
            jumpscareImg.src = jumpscareImage;
            jumpscareMessage.textContent = `${animatronicName} te atrap√≥`;
            jumpscareScreen.style.display = 'flex';
            
            // Reproducir sonido de susto (opcional, puedes agregar audio despu√©s)
            // const scareSound = new Audio('scream.mp3');
            // scareSound.play();
        }

        function victory() {
            gameRunning = false;
            document.getElementById('victory').style.display = 'flex';
            
            // Limpiar Golden Freddy si estaba activo
            if (goldenFreddyTimeout) {
                clearTimeout(goldenFreddyTimeout);
            }
            document.getElementById('golden-freddy').style.display = 'none';
        }

        // Funciones de Golden Freddy
        function trySpawnGoldenFreddy() {
            if (!gameRunning || gamePaused || goldenFreddyActive || cameraOpen) return;
            
            // 1 en 10 posibilidades (10%)
            if (Math.random() < 0.1) {
                spawnGoldenFreddy();
            }
        }

        function spawnGoldenFreddy() {
            goldenFreddyActive = true;
            document.getElementById('golden-freddy').style.display = 'flex';
            
            // 10 segundos para hacer click o abrir c√°maras
            goldenFreddyTimeout = setTimeout(() => {
                if (goldenFreddyActive && gameRunning) {
                    gameOver('Golden Freddy te ha atrapado!');
                }
            }, 10000);
        }

        function dismissGoldenFreddy() {
            if (goldenFreddyActive) {
                goldenFreddyActive = false;
                document.getElementById('golden-freddy').style.display = 'none';
                if (goldenFreddyTimeout) {
                    clearTimeout(goldenFreddyTimeout);
                }
            }
        }

        function toggleCamera() {
            cameraOpen = !cameraOpen;
            document.getElementById('camera-system').style.display = cameraOpen ? 'block' : 'none';
            document.getElementById('toggle-camera').textContent = cameraOpen ? 'CERRAR C√ÅMARAS [ESPACIO]' : 'ABRIR C√ÅMARAS [ESPACIO]';
            
            // Abrir c√°maras tambi√©n ahuyenta a Golden Freddy
            if (cameraOpen && goldenFreddyActive) {
                dismissGoldenFreddy();
            }
        }
        function togglePause() {
            gamePaused = !gamePaused;
            document.getElementById('pause-menu').style.display = gamePaused ? 'flex' : 'none';
        }

        function quitGame() {
            gameRunning = false;
            gamePaused = false;
            document.getElementById('pause-menu').style.display = 'none';
            document.getElementById('quit-screen').style.display = 'flex';
        }

        function showNewspaper() {
            document.getElementById('quit-screen').style.display = 'none';
            document.getElementById('newspaper-screen').style.display = 'flex';
            
            // Despu√©s de 5 segundos, permitir click
            setTimeout(() => {
                document.getElementById('newspaper-screen').style.pointerEvents = 'auto';
            }, 5000);
        }

        function handleJumpscareClick() {
            // Recargar la p√°gina para reiniciar completamente
            location.reload();
        }

        function handleNewspaperClick() {
            // Recargar la p√°gina para reiniciar completamente
            location.reload();
        }

        // Tecla Espacio para c√°maras
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameRunning && !gamePaused) {
                e.preventDefault();
                toggleCamera();
            }
            if (e.code === 'Escape' && gameRunning) {
                e.preventDefault();
                togglePause();
            }
        });
    </script>
</body>
</html>
